#include "model.hpp"
void Model::start(aiv::indx<1> offset){
    auto data_crop = data.crop( offset, data.N, Indx(1));
    double X = offset[0];
    data_crop[Indx(0)].E = 0;
    data_crop[Indx(0)].B = 0;
}
void Model::calc_cone_1(double init_time,aiv::indx<1> offset){
    double time = init_time;
    auto data_crop = data.crop( offset, data.N, Indx(1));
    double X = offset[0];
    data_crop[Indx(0)].E = data_crop[Indx(0)].E+C0*(data_crop[Indx(0)].B-sin(Omega*time));
    data_crop[Indx(1)].E = data_crop[Indx(1)].E+C1*(data_crop[Indx(1)].B-data_crop[Indx(0)].B);
    data_crop[Indx(2)].E = data_crop[Indx(2)].E+C1*(data_crop[Indx(2)].B-data_crop[Indx(1)].B);
    data_crop[Indx(3)].E = data_crop[Indx(3)].E+C1*(data_crop[Indx(3)].B-data_crop[Indx(2)].B);
    data_crop[Indx(4)].E = data_crop[Indx(4)].E+C1*(data_crop[Indx(4)].B-data_crop[Indx(3)].B);
    data_crop[Indx(5)].E = data_crop[Indx(5)].E+C1*(data_crop[Indx(5)].B-data_crop[Indx(4)].B);
    data_crop[Indx(6)].E = data_crop[Indx(6)].E+C1*(data_crop[Indx(6)].B-data_crop[Indx(5)].B);
    data_crop[Indx(7)].E = data_crop[Indx(7)].E+C1*(data_crop[Indx(7)].B-data_crop[Indx(6)].B);
    data_crop[Indx(8)].E = data_crop[Indx(8)].E+C1*(data_crop[Indx(8)].B-data_crop[Indx(7)].B);
    data_crop[Indx(9)].E = data_crop[Indx(9)].E+C1*(data_crop[Indx(9)].B-data_crop[Indx(8)].B);
    data_crop[Indx(10)].E = data_crop[Indx(10)].E+C1*(data_crop[Indx(10)].B-data_crop[Indx(9)].B);
    data_crop[Indx(11)].E = data_crop[Indx(11)].E+C1*(data_crop[Indx(11)].B-data_crop[Indx(10)].B);
    data_crop[Indx(12)].E = data_crop[Indx(12)].E+C1*(data_crop[Indx(12)].B-data_crop[Indx(11)].B);
    data_crop[Indx(13)].E = data_crop[Indx(13)].E+C1*(data_crop[Indx(13)].B-data_crop[Indx(12)].B);
    data_crop[Indx(14)].E = data_crop[Indx(14)].E+C1*(data_crop[Indx(14)].B-data_crop[Indx(13)].B);
    data_crop[Indx(15)].E = data_crop[Indx(15)].E+C1*(data_crop[Indx(15)].B-data_crop[Indx(14)].B);
    data_crop[Indx(16)].E = data_crop[Indx(16)].E+C1*(data_crop[Indx(16)].B-data_crop[Indx(15)].B);
    data_crop[Indx(17)].E = data_crop[Indx(17)].E+C1*(data_crop[Indx(17)].B-data_crop[Indx(16)].B);
    data_crop[Indx(18)].E = data_crop[Indx(18)].E+C1*(data_crop[Indx(18)].B-data_crop[Indx(17)].B);
    data_crop[Indx(19)].E = data_crop[Indx(19)].E+C1*(data_crop[Indx(19)].B-data_crop[Indx(18)].B);
    data_crop[Indx(20)].E = data_crop[Indx(20)].E+C1*(data_crop[Indx(20)].B-data_crop[Indx(19)].B);
    data_crop[Indx(21)].E = data_crop[Indx(21)].E+C1*(data_crop[Indx(21)].B-data_crop[Indx(20)].B);
    data_crop[Indx(22)].E = data_crop[Indx(22)].E+C1*(data_crop[Indx(22)].B-data_crop[Indx(21)].B);
    data_crop[Indx(23)].E = data_crop[Indx(23)].E+C1*(data_crop[Indx(23)].B-data_crop[Indx(22)].B);
    data_crop[Indx(24)].E = data_crop[Indx(24)].E+C1*(data_crop[Indx(24)].B-data_crop[Indx(23)].B);
    data_crop[Indx(25)].E = data_crop[Indx(25)].E+C1*(data_crop[Indx(25)].B-data_crop[Indx(24)].B);
    data_crop[Indx(26)].E = data_crop[Indx(26)].E+C1*(data_crop[Indx(26)].B-data_crop[Indx(25)].B);
    data_crop[Indx(27)].E = data_crop[Indx(27)].E+C1*(data_crop[Indx(27)].B-data_crop[Indx(26)].B);
    data_crop[Indx(28)].E = data_crop[Indx(28)].E+C1*(data_crop[Indx(28)].B-data_crop[Indx(27)].B);
    data_crop[Indx(29)].E = data_crop[Indx(29)].E+C1*(data_crop[Indx(29)].B-data_crop[Indx(28)].B);
    data_crop[Indx(30)].E = data_crop[Indx(30)].E+C1*(data_crop[Indx(30)].B-data_crop[Indx(29)].B);
    data_crop[Indx(31)].E = data_crop[Indx(31)].E+C1*(data_crop[Indx(31)].B-data_crop[Indx(30)].B);
    data_crop[Indx(32)].E = data_crop[Indx(32)].E+C1*(data_crop[Indx(32)].B-data_crop[Indx(31)].B);
    data_crop[Indx(33)].E = data_crop[Indx(33)].E+C1*(data_crop[Indx(33)].B-data_crop[Indx(32)].B);
    data_crop[Indx(34)].E = data_crop[Indx(34)].E+C1*(data_crop[Indx(34)].B-data_crop[Indx(33)].B);
    data_crop[Indx(35)].E = data_crop[Indx(35)].E+C1*(data_crop[Indx(35)].B-data_crop[Indx(34)].B);
    data_crop[Indx(36)].E = data_crop[Indx(36)].E+C1*(data_crop[Indx(36)].B-data_crop[Indx(35)].B);
    data_crop[Indx(37)].E = data_crop[Indx(37)].E+C1*(data_crop[Indx(37)].B-data_crop[Indx(36)].B);
    data_crop[Indx(38)].E = data_crop[Indx(38)].E+C1*(data_crop[Indx(38)].B-data_crop[Indx(37)].B);
    data_crop[Indx(39)].E = data_crop[Indx(39)].E+C1*(data_crop[Indx(39)].B-data_crop[Indx(38)].B);
    data_crop[Indx(40)].E = data_crop[Indx(40)].E+C1*(data_crop[Indx(40)].B-data_crop[Indx(39)].B);
    data_crop[Indx(41)].E = data_crop[Indx(41)].E+C1*(data_crop[Indx(41)].B-data_crop[Indx(40)].B);
    data_crop[Indx(42)].E = data_crop[Indx(42)].E+C1*(data_crop[Indx(42)].B-data_crop[Indx(41)].B);
    data_crop[Indx(43)].E = data_crop[Indx(43)].E+C1*(data_crop[Indx(43)].B-data_crop[Indx(42)].B);
    data_crop[Indx(44)].E = data_crop[Indx(44)].E+C1*(data_crop[Indx(44)].B-data_crop[Indx(43)].B);
    data_crop[Indx(45)].E = data_crop[Indx(45)].E+C1*(data_crop[Indx(45)].B-data_crop[Indx(44)].B);
    data_crop[Indx(46)].E = data_crop[Indx(46)].E+C1*(data_crop[Indx(46)].B-data_crop[Indx(45)].B);
    data_crop[Indx(47)].E = data_crop[Indx(47)].E+C1*(data_crop[Indx(47)].B-data_crop[Indx(46)].B);
    data_crop[Indx(48)].E = data_crop[Indx(48)].E+C1*(data_crop[Indx(48)].B-data_crop[Indx(47)].B);
    data_crop[Indx(49)].E = data_crop[Indx(49)].E+C2*(data_crop[Indx(49)].B-data_crop[Indx(48)].B);
    data_crop[Indx(0)].B = data_crop[Indx(0)].B+C0*(data_crop[Indx(1)].E-data_crop[Indx(0)].E);
    data_crop[Indx(1)].B = data_crop[Indx(1)].B+C1*(data_crop[Indx(2)].E-data_crop[Indx(1)].E);
    data_crop[Indx(2)].B = data_crop[Indx(2)].B+C1*(data_crop[Indx(3)].E-data_crop[Indx(2)].E);
    data_crop[Indx(3)].B = data_crop[Indx(3)].B+C1*(data_crop[Indx(4)].E-data_crop[Indx(3)].E);
    data_crop[Indx(4)].B = data_crop[Indx(4)].B+C1*(data_crop[Indx(5)].E-data_crop[Indx(4)].E);
    data_crop[Indx(5)].B = data_crop[Indx(5)].B+C1*(data_crop[Indx(6)].E-data_crop[Indx(5)].E);
    data_crop[Indx(6)].B = data_crop[Indx(6)].B+C1*(data_crop[Indx(7)].E-data_crop[Indx(6)].E);
    data_crop[Indx(7)].B = data_crop[Indx(7)].B+C1*(data_crop[Indx(8)].E-data_crop[Indx(7)].E);
    data_crop[Indx(8)].B = data_crop[Indx(8)].B+C1*(data_crop[Indx(9)].E-data_crop[Indx(8)].E);
    data_crop[Indx(9)].B = data_crop[Indx(9)].B+C1*(data_crop[Indx(10)].E-data_crop[Indx(9)].E);
    data_crop[Indx(10)].B = data_crop[Indx(10)].B+C1*(data_crop[Indx(11)].E-data_crop[Indx(10)].E);
    data_crop[Indx(11)].B = data_crop[Indx(11)].B+C1*(data_crop[Indx(12)].E-data_crop[Indx(11)].E);
    data_crop[Indx(12)].B = data_crop[Indx(12)].B+C1*(data_crop[Indx(13)].E-data_crop[Indx(12)].E);
    data_crop[Indx(13)].B = data_crop[Indx(13)].B+C1*(data_crop[Indx(14)].E-data_crop[Indx(13)].E);
    data_crop[Indx(14)].B = data_crop[Indx(14)].B+C1*(data_crop[Indx(15)].E-data_crop[Indx(14)].E);
    data_crop[Indx(15)].B = data_crop[Indx(15)].B+C1*(data_crop[Indx(16)].E-data_crop[Indx(15)].E);
    data_crop[Indx(16)].B = data_crop[Indx(16)].B+C1*(data_crop[Indx(17)].E-data_crop[Indx(16)].E);
    data_crop[Indx(17)].B = data_crop[Indx(17)].B+C1*(data_crop[Indx(18)].E-data_crop[Indx(17)].E);
    data_crop[Indx(18)].B = data_crop[Indx(18)].B+C1*(data_crop[Indx(19)].E-data_crop[Indx(18)].E);
    data_crop[Indx(19)].B = data_crop[Indx(19)].B+C1*(data_crop[Indx(20)].E-data_crop[Indx(19)].E);
    data_crop[Indx(20)].B = data_crop[Indx(20)].B+C1*(data_crop[Indx(21)].E-data_crop[Indx(20)].E);
    data_crop[Indx(21)].B = data_crop[Indx(21)].B+C1*(data_crop[Indx(22)].E-data_crop[Indx(21)].E);
    data_crop[Indx(22)].B = data_crop[Indx(22)].B+C1*(data_crop[Indx(23)].E-data_crop[Indx(22)].E);
    data_crop[Indx(23)].B = data_crop[Indx(23)].B+C1*(data_crop[Indx(24)].E-data_crop[Indx(23)].E);
    data_crop[Indx(24)].B = data_crop[Indx(24)].B+C1*(data_crop[Indx(25)].E-data_crop[Indx(24)].E);
    data_crop[Indx(25)].B = data_crop[Indx(25)].B+C1*(data_crop[Indx(26)].E-data_crop[Indx(25)].E);
    data_crop[Indx(26)].B = data_crop[Indx(26)].B+C1*(data_crop[Indx(27)].E-data_crop[Indx(26)].E);
    data_crop[Indx(27)].B = data_crop[Indx(27)].B+C1*(data_crop[Indx(28)].E-data_crop[Indx(27)].E);
    data_crop[Indx(28)].B = data_crop[Indx(28)].B+C1*(data_crop[Indx(29)].E-data_crop[Indx(28)].E);
    data_crop[Indx(29)].B = data_crop[Indx(29)].B+C1*(data_crop[Indx(30)].E-data_crop[Indx(29)].E);
    data_crop[Indx(30)].B = data_crop[Indx(30)].B+C1*(data_crop[Indx(31)].E-data_crop[Indx(30)].E);
    data_crop[Indx(31)].B = data_crop[Indx(31)].B+C1*(data_crop[Indx(32)].E-data_crop[Indx(31)].E);
    data_crop[Indx(32)].B = data_crop[Indx(32)].B+C1*(data_crop[Indx(33)].E-data_crop[Indx(32)].E);
    data_crop[Indx(33)].B = data_crop[Indx(33)].B+C1*(data_crop[Indx(34)].E-data_crop[Indx(33)].E);
    data_crop[Indx(34)].B = data_crop[Indx(34)].B+C1*(data_crop[Indx(35)].E-data_crop[Indx(34)].E);
    data_crop[Indx(35)].B = data_crop[Indx(35)].B+C1*(data_crop[Indx(36)].E-data_crop[Indx(35)].E);
    data_crop[Indx(36)].B = data_crop[Indx(36)].B+C1*(data_crop[Indx(37)].E-data_crop[Indx(36)].E);
    data_crop[Indx(37)].B = data_crop[Indx(37)].B+C1*(data_crop[Indx(38)].E-data_crop[Indx(37)].E);
    data_crop[Indx(38)].B = data_crop[Indx(38)].B+C1*(data_crop[Indx(39)].E-data_crop[Indx(38)].E);
    data_crop[Indx(39)].B = data_crop[Indx(39)].B+C1*(data_crop[Indx(40)].E-data_crop[Indx(39)].E);
    data_crop[Indx(40)].B = data_crop[Indx(40)].B+C1*(data_crop[Indx(41)].E-data_crop[Indx(40)].E);
    data_crop[Indx(41)].B = data_crop[Indx(41)].B+C1*(data_crop[Indx(42)].E-data_crop[Indx(41)].E);
    data_crop[Indx(42)].B = data_crop[Indx(42)].B+C1*(data_crop[Indx(43)].E-data_crop[Indx(42)].E);
    data_crop[Indx(43)].B = data_crop[Indx(43)].B+C1*(data_crop[Indx(44)].E-data_crop[Indx(43)].E);
    data_crop[Indx(44)].B = data_crop[Indx(44)].B+C1*(data_crop[Indx(45)].E-data_crop[Indx(44)].E);
    data_crop[Indx(45)].B = data_crop[Indx(45)].B+C1*(data_crop[Indx(46)].E-data_crop[Indx(45)].E);
    data_crop[Indx(46)].B = data_crop[Indx(46)].B+C1*(data_crop[Indx(47)].E-data_crop[Indx(46)].E);
    data_crop[Indx(47)].B = data_crop[Indx(47)].B+C1*(data_crop[Indx(48)].E-data_crop[Indx(47)].E);
    data_crop[Indx(48)].B = data_crop[Indx(48)].B+C1*(data_crop[Indx(49)].E-data_crop[Indx(48)].E);
    data_crop[Indx(49)].B = data_crop[Indx(49)].B+C2*(0-data_crop[Indx(49)].E);
}